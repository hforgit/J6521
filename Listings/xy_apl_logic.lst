C51 COMPILER V9.01   XY_APL_LOGIC                                                          03/06/2021 13:59:18 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE XY_APL_LOGIC
OBJECT MODULE PLACED IN .\Objects\xy_apl_logic.obj
COMPILER INVOKED BY: D:\MDK5\C51\BIN\C51.EXE 01_APL\xy_apl_logic.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(.\01_APL;.
                    -\02_FML;.\03_HAL;.\04_SYS) DEBUG PRINT(.\Listings\xy_apl_logic.lst) OBJECT(.\Objects\xy_apl_logic.obj)

line level    source

   1          #include "xy_sys_headfile.h"
   2          
   3          static datall* s_p_data = &g_datall;
   4          
   5          /*********************************************************************************************************
             -**************
   6          * Function Name: 
   7          * Description  : 
   8          * Arguments    : None
   9          * Return Value : None
  10          **********************************************************************************************************
             -*************/
  11          void apl_init_data(void)
  12          {
  13   1              fml_buzzer_init_data(s_p_data);
  14   1              fml_ctrl_init_data(s_p_data);
  15   1              fml_touch_init_data(s_p_data);
  16   1              fml_motor_init_data(s_p_data);
  17   1      }
  18          
  19          /*********************************************************************************************************
             -**************
  20          * Function Name: 
  21          * Description  : 
  22          * Arguments    : None
  23          * Return Value : None
  24          **********************************************************************************************************
             -*************/
  25          void apl_config_data(void)
  26          {
  27   1              s_p_data->buzzer.normal_bee_on  = ON; 
  28   1              s_p_data->keytype                       = REMOTE;
  29   1              memset(&g_timebase.isTrigInterrupt, 0, sizeof(g_timebase));
  30   1      }
  31          
  32          /*********************************************************************************************************
             -**************
  33          * Function Name: 
  34          * Description  : 
  35          * Arguments    : None
  36          * Return Value : None
  37          **********************************************************************************************************
             -*************/
  38          void apl_config_register(void)
  39          {
  40   1              fml_ctrl_init_reg();
  41   1      }
  42          
  43          /*********************************************************************************************************
             -**************
  44          * Function Name: 
  45          * Description  : 
  46          * Arguments    : None
  47          * Return Value : None
C51 COMPILER V9.01   XY_APL_LOGIC                                                          03/06/2021 13:59:18 PAGE 2   

  48          **********************************************************************************************************
             -*************/
  49          void apl_initialize(void)
  50          {
  51   1              apl_init_data();
  52   1              apl_config_data();
  53   1              apl_config_register();
  54   1      }
  55          
  56          /*********************************************************************************************************
             -**************
  57          * Function Name: 
  58          * Description  : 
  59          * Arguments    : None
  60          * Return Value : None
  61          **********************************************************************************************************
             -*************/
  62          void apl_logic_ctrl(void)
  63          {
  64   1              /* period: 125us */
  65   1              if (g_timebase.isTrigInterrupt)
  66   1          {
  67   2                      g_timebase.isTrigInterrupt = 0;
  68   2                      g_timebase.timebase_125us++;
  69   2          }
  70   1      
  71   1              /* period: 1ms */
  72   1          if (g_timebase.timebase_125us >= 8)
  73   1          {
  74   2              g_timebase.timebase_125us = 0;
  75   2                      g_timebase.timebase_1ms++;
  76   2      
  77   2                      fml_buzzer_timer_cnt(s_p_data);
  78   2                      fml_motor_timer_ctrl(s_p_data);
  79   2                      fml_motor_ctrl_move(s_p_data);
  80   2                      
  81   2                      if(s_p_data->uart.send_data == 1)
  82   2                      {
  83   3                              hal_irq_uart1_send(s_p_data->uart.send_uart1_dat,s_p_data->uart.send_uart1_len);                
  84   3                      }
  85   2              }
  86   1      
  87   1              /* period: 10ms */
  88   1          if (g_timebase.timebase_1ms >= 10)
  89   1          {
  90   2              g_timebase.timebase_1ms = 0;
  91   2              g_timebase.timebase_10ms++;
  92   2                      g_timebase.timebase_100ms++;
  93   2              g_timebase.timebase_250ms++;
  94   2      
  95   2                      fml_ctrl_key_logic(s_p_data);
  96   2                      fml_touch_ctrl_logic(s_p_data);
  97   2          }
  98   1      
  99   1              /* period: 50ms */
 100   1          if (g_timebase.timebase_10ms >= 5)
 101   1          {
 102   2                      g_timebase.timebase_10ms = 0;
 103   2      
 104   2                      fml_buzzer_deal(s_p_data);
 105   2          }
 106   1      
C51 COMPILER V9.01   XY_APL_LOGIC                                                          03/06/2021 13:59:18 PAGE 3   

 107   1              /* period: 100ms */
 108   1          if (g_timebase.timebase_100ms >= 9)
 109   1          {
 110   2              g_timebase.timebase_100ms = 0;
 111   2      
 112   2                      fml_ctrl_icon_display(s_p_data);
 113   2          }
 114   1      
 115   1              /* period: 250ms */
 116   1          if (g_timebase.timebase_250ms >= 24)
 117   1          {
 118   2              g_timebase.timebase_250ms = 0;
 119   2                      g_timebase.timebase_500ms++;
 120   2      
 121   2                      fml_relay_ctrl(s_p_data);
 122   2                      fml_display_conf_symbol(s_p_data);
 123   2                      fml_display_tx_data(s_p_data);
 124   2                      watchdog();     
 125   2          }
 126   1      
 127   1              /* period: 500ms */
 128   1          if (g_timebase.timebase_500ms >= 2)
 129   1          {
 130   2              g_timebase.timebase_500ms = 0;
 131   2              g_timebase.timebase_1s++;
 132   2      
 133   2                      #ifdef XY_SYS_TEST_MODE
 134   2                              s_p_data->testmode = fml_test_check();
 135   2                              fml_test_logic(s_p_data);
 136   2                      #endif
 137   2          }
 138   1      
 139   1              /* period: 1s */
 140   1          if (g_timebase.timebase_1s >= 2)
 141   1          {
 142   2              g_timebase.timebase_1s = 0;
 143   2      
 144   2                      fml_ctrl_deal_timer(s_p_data);
 145   2                      fml_ctrl_work_time(s_p_data);
 146   2                      fml_ctrl_deal_alarm(s_p_data);
 147   2          }
 148   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    487    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      3    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
